{
  "intent_response_handling": {
    "description": "How to handle the intent response and provide context data",
    "scenario": "AI requests backend data for assignments and schedule",
    "next_endpoint": "POST /chat/chat/context"
  },
  "context_request_example": {
    "description": "Sample context request to continue the conversation",
    "request_body": {
      "conversation_id": "conv_photography_planning_2025",
      "user_id": "photographer_001",
      "context_data": {
        "assignments": [
          {
            "assignment_id": "assign_portrait_techniques",
            "title": "Portrait Photography Techniques",
            "description": "Master studio lighting, composition, and posing techniques",
            "due_date": "2025-01-20T23:59:59.000Z",
            "status": "in_progress",
            "project_id": "proj_portfolio_2025",
            "requirements": [
              "Complete 3 different lighting setups",
              "Practice with 5 different poses",
              "Submit 10 best shots for review"
            ]
          },
          {
            "assignment_id": "assign_landscape_composition",
            "title": "Landscape Composition Mastery",
            "description": "Learn and apply landscape photography composition rules",
            "due_date": "2025-01-25T23:59:59.000Z",
            "status": "not_started",
            "project_id": "proj_portfolio_2025",
            "requirements": [
              "Study rule of thirds application",
              "Practice leading lines techniques",
              "Capture golden hour landscapes"
            ]
          }
        ],
        "schedule": {
          "available_slots": [
            {
              "date": "2025-01-12",
              "time_slots": [
                { "start": "09:00", "end": "12:00", "type": "studio" },
                { "start": "14:00", "end": "17:00", "type": "outdoor" }
              ]
            },
            {
              "date": "2025-01-15",
              "time_slots": [
                { "start": "06:00", "end": "09:00", "type": "golden_hour" },
                { "start": "10:00", "end": "13:00", "type": "studio" }
              ]
            },
            {
              "date": "2025-01-18",
              "time_slots": [
                { "start": "15:00", "end": "18:00", "type": "outdoor" },
                { "start": "19:00", "end": "22:00", "type": "studio" }
              ]
            }
          ],
          "equipment_bookings": [
            {
              "equipment": "Studio Lights",
              "booked_dates": ["2025-01-12", "2025-01-15"],
              "available": true
            },
            {
              "equipment": "Portrait Lens (85mm)",
              "booked_dates": ["2025-01-15"],
              "available": true
            }
          ]
        },
        "existing_tasks": [
          {
            "task_id": "task_portrait_shoot_1",
            "title": "Portrait Photography Session - Studio Setup",
            "description": "Conduct portrait photography session with professional lighting setup",
            "due_datetime": "2025-01-15T14:00:00.000Z",
            "status": "not_started",
            "project_id": "proj_portfolio_2025",
            "dependencies": ["task_equipment_check"],
            "estimated_duration": "3 hours"
          },
          {
            "task_id": "task_landscape_scouting",
            "title": "Landscape Location Scouting",
            "description": "Research and visit potential landscape photography locations",
            "due_datetime": "2025-01-20T09:00:00.000Z",
            "status": "not_started",
            "project_id": "proj_portfolio_2025",
            "dependencies": [],
            "estimated_duration": "4 hours"
          },
          {
            "task_id": "task_equipment_check",
            "title": "Equipment Maintenance and Check",
            "description": "Clean lenses, check camera settings, and ensure all equipment is ready",
            "due_datetime": "2025-01-10T10:00:00.000Z",
            "status": "in_progress",
            "project_id": "proj_portfolio_2025",
            "dependencies": [],
            "estimated_duration": "2 hours"
          }
        ]
      },
      "stage": "response"
    }
  },
  "curl_context_example": {
    "description": "Curl command to provide context and continue the conversation",
    "command": "curl -X POST 'http://localhost:8000/chat/chat/context' \\\n  -H 'Content-Type: application/json' \\\n  -H 'Authorization: Bearer YOUR_API_TOKEN' \\\n  -d '{\n    \"conversation_id\": \"conv_photography_planning_2025\",\n    \"user_id\": \"photographer_001\",\n    \"context_data\": {\n      \"assignments\": [\n        {\n          \"assignment_id\": \"assign_portrait_techniques\",\n          \"title\": \"Portrait Photography Techniques\",\n          \"description\": \"Master studio lighting, composition, and posing techniques\",\n          \"due_date\": \"2025-01-20T23:59:59.000Z\",\n          \"status\": \"in_progress\",\n          \"project_id\": \"proj_portfolio_2025\",\n          \"requirements\": [\n            \"Complete 3 different lighting setups\",\n            \"Practice with 5 different poses\",\n            \"Submit 10 best shots for review\"\n          ]\n        }\n      ],\n      \"schedule\": {\n        \"available_slots\": [\n          {\n            \"date\": \"2025-01-12\",\n            \"time_slots\": [\n              {\"start\": \"09:00\", \"end\": \"12:00\", \"type\": \"studio\"},\n              {\"start\": \"14:00\", \"end\": \"17:00\", \"type\": \"outdoor\"}\n            ]\n          }\n        ],\n        \"equipment_bookings\": [\n          {\n            \"equipment\": \"Studio Lights\",\n            \"booked_dates\": [\"2025-01-12\", \"2025-01-15\"],\n            \"available\": true\n          }\n        ]\n      }\n    },\n    \"stage\": \"response\"\n  }'"
  },
  "expected_final_response": {
    "description": "What you can expect after providing context",
    "response_structure": {
      "stage": "response",
      "conversation_id": "conv_photography_planning_2025",
      "text": "Perfect! Now I have all the information I need. Based on your assignments, schedule, and existing tasks, I've created a comprehensive todo list that aligns with your photography portfolio project.",
      "blocks": [
        {
          "type": "todo_list",
          "list_title": "Photography Portfolio Project - Optimized Task List",
          "items": [
            {
              "title": "Complete Equipment Check (In Progress)",
              "description": "Finish cleaning lenses and testing camera settings",
              "project_id": "proj_portfolio_2025",
              "task_id": "task_equipment_check",
              "due_datetime": "2025-01-10T10:00:00.000Z"
            },
            {
              "title": "Portrait Techniques Assignment Practice",
              "description": "Practice 3 lighting setups and 5 poses for assignment",
              "project_id": "proj_portfolio_2025",
              "task_id": "task_portrait_practice",
              "due_datetime": "2025-01-12T09:00:00.000Z"
            },
            {
              "title": "Portrait Photography Session",
              "description": "Studio session with professional lighting setup",
              "project_id": "proj_portfolio_2025",
              "task_id": "task_portrait_shoot_1",
              "due_datetime": "2025-01-15T10:00:00.000Z"
            },
            {
              "title": "Landscape Location Scouting",
              "description": "Research and visit potential landscape photography locations",
              "project_id": "proj_portfolio_2025",
              "task_id": "task_landscape_scouting",
              "due_datetime": "2025-01-18T15:00:00.000Z"
            },
            {
              "title": "Golden Hour Landscape Shoot",
              "description": "Capture landscapes during optimal lighting conditions",
              "project_id": "proj_portfolio_2025",
              "task_id": "task_landscape_shoot",
              "due_datetime": "2025-01-15T06:00:00.000Z"
            },
            {
              "title": "Submit Portrait Assignment",
              "description": "Submit 10 best portrait shots for review",
              "project_id": "proj_portfolio_2025",
              "task_id": "task_submit_portrait",
              "due_datetime": "2025-01-20T23:59:59.000Z"
            }
          ],
          "footer": "Tasks are optimized based on your schedule availability and assignment deadlines.",
          "accept_decline": true
        },
        {
          "type": "explanation_block",
          "title": "Schedule Optimization Notes",
          "description": "Your tasks have been optimized based on available time slots and equipment bookings:",
          "blocks": [
            {
              "title": "Equipment Availability",
              "description": "Studio lights are booked for Jan 12 & 15 - perfect for portrait sessions",
              "list": [
                "Jan 12: Studio session (09:00-12:00) for practice",
                "Jan 15: Studio session (10:00-13:00) for main shoot",
                "Portrait lens available for both sessions"
              ]
            },
            {
              "title": "Assignment Alignment",
              "description": "Tasks align with your portrait techniques assignment requirements",
              "list": [
                "Practice session on Jan 12 covers lighting setups",
                "Main shoot on Jan 15 captures final portfolio shots",
                "Submission deadline Jan 20 allows for post-processing"
              ]
            }
          ],
          "footer": "This schedule maximizes your available equipment and meets assignment deadlines."
        }
      ],
      "intent": null,
      "timestamp": "2025-01-06T18:25:15.123Z",
      "token_usage": {
        "prompt_tokens": 320,
        "completion_tokens": 280,
        "total_tokens": 600,
        "embedding_tokens": 0,
        "cost_estimate_usd": 0.0018
      }
    }
  },
  "javascript_context_handler": {
    "description": "JavaScript function to handle intent and provide context",
    "code": "const handleIntentResponse = async (intentResponse) => {\n  // Check if this is an intent response that needs context\n  if (intentResponse.stage === 'intent' && intentResponse.intent) {\n    \n    const { intent } = intentResponse;\n    \n    // Prepare context data based on what the AI is requesting\n    let contextData = {};\n    \n    if (intent.targets.includes('assignments')) {\n      contextData.assignments = await fetchAssignments(intent.filters.project_ids);\n    }\n    \n    if (intent.targets.includes('schedule')) {\n      contextData.schedule = await fetchSchedule(intent.filters.task_ids);\n    }\n    \n    // Continue the conversation with context\n    const contextRequest = {\n      conversation_id: intentResponse.conversation_id,\n      user_id: \"photographer_001\",\n      context_data: contextData,\n      stage: \"response\"\n    };\n    \n    try {\n      const response = await fetch('http://localhost:8000/chat/chat/context', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer YOUR_API_TOKEN'\n        },\n        body: JSON.stringify(contextRequest)\n      });\n      \n      const finalResponse = await response.json();\n      \n      if (response.ok) {\n        console.log('Final todo list created:', finalResponse);\n        return finalResponse;\n      } else {\n        console.error('Error providing context:', finalResponse);\n      }\n    } catch (error) {\n      console.error('Network error:', error);\n    }\n  }\n};\n\n// Helper functions to fetch data from your backend\nconst fetchAssignments = async (projectIds) => {\n  // Replace with your actual API call\n  return [\n    {\n      assignment_id: \"assign_portrait_techniques\",\n      title: \"Portrait Photography Techniques\",\n      description: \"Master studio lighting, composition, and posing techniques\",\n      due_date: \"2025-01-20T23:59:59.000Z\",\n      status: \"in_progress\",\n      project_id: \"proj_portfolio_2025\"\n    }\n  ];\n};\n\nconst fetchSchedule = async (taskIds) => {\n  // Replace with your actual API call\n  return {\n    available_slots: [\n      {\n        date: \"2025-01-12\",\n        time_slots: [\n          {start: \"09:00\", end: \"12:00\", type: \"studio\"}\n        ]\n      }\n    ]\n  };\n};"
  },
  "workflow_explanation": {
    "step_1": "Initial chat request returns intent response",
    "step_2": "AI requests specific data (assignments, schedule)",
    "step_3": "Your backend fetches the requested data",
    "step_4": "Send context data to /chat/chat/context endpoint",
    "step_5": "AI processes context and returns complete todo list",
    "benefits": [
      "AI gets real-time data from your system",
      "Todo list is optimized based on actual constraints",
      "Tasks align with existing assignments and schedules",
      "Equipment availability is considered in planning"
    ]
  }
}
